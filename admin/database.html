<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>We Play Admin - データベース設計</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/admin.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        .table-definition {
            margin-bottom: 3rem;
        }

        .table-definition h2 {
            font-size: 1.4rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .table-definition h2 i {
            color: var(--primary);
        }

        .table-definition p {
            color: var(--text-dim);
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
        }

        .data-table th {
            color: var(--text-main);
            font-weight: 700;
        }

        .column-type {
            font-family: 'Outfit', sans-serif;
            font-size: 0.85rem;
            color: var(--primary);
            background: rgba(0, 242, 255, 0.1);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }
    </style>
</head>

<body>
    <div class="admin-container">
        <!-- Sidebar (Generated by components.js) -->
        <div id="app-sidebar"></div>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-header">
                <div class="header-title" style="display: flex; align-items: center; gap: 1rem;">
                    <div style="width: 3px; height: 18px; background: var(--primary); border-radius: 2px;"></div>
                    <h1 style="font-size: 1.1rem; font-weight: 800; color: #fff; letter-spacing: 0.5px;">We Play
                        未来人財育成委員会 事業ポータル</h1>
                </div>
                <div class="user-profile">
                    <div class="notifications">
                        <i data-lucide="bell"></i>
                        <span class="badge"></span>
                    </div>
                    <div class="avatar">
                        <img src="https://ui-avatars.com/api/?name=Admin&background=7000ff&color=fff" alt="Admin">
                    </div>
                </div>
            </header>

            <div class="content-wrapper">
                <div class="welcome-banner">
                    <h1>データベース設計</h1>
                    <p>システムの主要なテーブル構成とデータ定義を管理します。</p>
                </div>

                <!-- Collaborators Table -->
                <section class="table-definition">
                    <h2><i data-lucide="table-2"></i> 協力者 (collaborators)</h2>
                    <p>事業に協力していただく企業や個人の情報を管理します。</p>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>論理名</th>
                                    <th>物理名 (列名)</th>
                                    <th>データ型</th>
                                    <th>備考</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ID</td>
                                    <td>id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>プライマリキー</td>
                                </tr>
                                <tr>
                                    <td>会社名</td>
                                    <td>company_name</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>会社名ふりがな</td>
                                    <td>company_kana</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>担当者名</td>
                                    <td>contact_name</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>担当者ふりがな</td>
                                    <td>contact_kana</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>電話番号</td>
                                    <td>phone</td>
                                    <td><span class="column-type">VARCHAR(20)</span></td>
                                    <td>ハイフンあり</td>
                                </tr>
                                <tr>
                                    <td>メールアドレス</td>
                                    <td>email</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td>一意制約</td>
                                </tr>
                                <tr>
                                    <td>協力カテゴリー</td>
                                    <td>category</td>
                                    <td><span class="column-type">VARCHAR(100)</span></td>
                                    <td>広報協力, 講師など</td>
                                </tr>
                                <tr>
                                    <td>備考</td>
                                    <td>notes</td>
                                    <td><span class="column-type">TEXT</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>登録日</td>
                                    <td>created_at</td>
                                    <td><span class="column-type">TIMESTAMP</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>更新日</td>
                                    <td>updated_at</td>
                                    <td><span class="column-type">TIMESTAMP</span></td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Members Table -->
                <section class="table-definition">
                    <h2><i data-lucide="table-2"></i> 正会員 (members)</h2>
                    <p>福山JC正会員（サポーター・コーディネーター等）の情報を管理します。</p>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>論理名</th>
                                    <th>物理名 (列名)</th>
                                    <th>データ型</th>
                                    <th>備考</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ID</td>
                                    <td>id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>プライマリキー</td>
                                </tr>
                                <tr>
                                    <td>Auth User ID</td>
                                    <td>auth_user_id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>Supabase Auth (auth.users) との紐付け</td>
                                </tr>
                                <tr>
                                    <td>メールアドレス</td>
                                    <td>email</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td>auth.usersのemailと同期（NOT NULL）</td>
                                </tr>
                                <tr>
                                    <td>氏名</td>
                                    <td>full_name</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>ふりがな</td>
                                    <td>full_kana</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>出身高校</td>
                                    <td>high_school</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td>元データ: email項目の直下に表示</td>
                                </tr>
                                <tr>
                                <tr>
                                    <td>所属ID</td>
                                    <td>organization_id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>FK: master_organization.id</td>
                                </tr>
                                <tr>
                                    <td>役職ID</td>
                                    <td>position_id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>FK: master_position.id</td>
                                </tr>
                                <tr>
                                    <td>役割ID</td>
                                    <td>project_role_id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>FK: master_project_role.id</td>
                                </tr>
                                <tr>
                                    <td>スタッフ判定</td>
                                    <td>is_staff</td>
                                    <td><span class="column-type">BOOLEAN</span></td>
                                    <td>委員会スタッフ等の判定に使用</td>
                                </tr>
                                <tr>
                                    <td>LINE承認権限</td>
                                    <td>can_approve_line</td>
                                    <td><span class="column-type">BOOLEAN</span></td>
                                    <td>LINEメッセージを承認できる権限</td>
                                </tr>
                                <tr>
                                    <td>LINE USER ID</td>
                                    <td>line_user_id</td>
                                    <td><span class="column-type">VARCHAR(50)</span></td>
                                    <td>Messaging APIでのマルチキャスト配信に使用</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section id="master-organization" class="table-definition">
                    <h2><i data-lucide="database"></i> 所属マスター (master_organization)</h2>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>論理名</th>
                                    <th>物理名 (列名)</th>
                                    <th>データ型</th>
                                    <th>備考</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ID</td>
                                    <td>id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>PK</td>
                                </tr>
                                <tr>
                                    <td>名称</td>
                                    <td>name</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td>未来人財育成委員会, 広報渉外委員会など</td>
                                </tr>
                                <tr>
                                    <td>順序</td>
                                    <td>sort_order</td>
                                    <td><span class="column-type">INTEGER</span></td>
                                    <td>表示順</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section id="master-position" class="table-definition">
                    <h2><i data-lucide="database"></i> 役職マスター (master_position)</h2>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>論理名</th>
                                    <th>物理名 (列名)</th>
                                    <th>データ型</th>
                                    <th>備考</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ID</td>
                                    <td>id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>PK</td>
                                </tr>
                                <tr>
                                    <td>名称</td>
                                    <td>name</td>
                                    <td><span class="column-type">VARCHAR(100)</span></td>
                                    <td>委員長, 副委員長, 委員など</td>
                                </tr>
                                <tr>
                                    <td>順序</td>
                                    <td>sort_order</td>
                                    <td><span class="column-type">INTEGER</span></td>
                                    <td>表示順</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section id="master-project-role" class="table-definition">
                    <h2><i data-lucide="database"></i> 事業役割マスター (master_project_role)</h2>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>論理名</th>
                                    <th>物理名 (列名)</th>
                                    <th>データ型</th>
                                    <th>備考</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ID</td>
                                    <td>id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>PK</td>
                                </tr>
                                <tr>
                                    <td>名称</td>
                                    <td>name</td>
                                    <td><span class="column-type">VARCHAR(100)</span></td>
                                    <td>事業責任者, コーディネーター, サポーターなど</td>
                                </tr>
                                <tr>
                                    <td>順序</td>
                                    <td>sort_order</td>
                                    <td><span class="column-type">INTEGER</span></td>
                                    <td>表示順</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section id="master-role" class="table-definition">
                    <h2><i data-lucide="database"></i> 参加者役割マスター (master_role)</h2>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>論理名</th>
                                    <th>物理名 (列名)</th>
                                    <th>データ型</th>
                                    <th>備考</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ID</td>
                                    <td>id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>PK</td>
                                </tr>
                                <tr>
                                    <td>名称</td>
                                    <td>name</td>
                                    <td><span class="column-type">VARCHAR(100)</span></td>
                                    <td>監督, 脚本, 演者など</td>
                                </tr>
                                <tr>
                                    <td>順序</td>
                                    <td>sort_order</td>
                                    <td><span class="column-type">INTEGER</span></td>
                                    <td>表示順</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section id="master-school" class="table-definition">
                    <h2><i data-lucide="database"></i> 学校マスター (master_school)</h2>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>論理名</th>
                                    <th>物理名 (列名)</th>
                                    <th>データ型</th>
                                    <th>備考</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ID</td>
                                    <td>id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>PK</td>
                                </tr>
                                <tr>
                                    <td>学校名</td>
                                    <td>name</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td>〇〇中学校, 〇〇高校など</td>
                                </tr>
                                <tr>
                                    <td>校種</td>
                                    <td>type</td>
                                    <td><span class="column-type">VARCHAR(50)</span></td>
                                    <td>中学校, 高校</td>
                                </tr>
                                <tr>
                                    <td>順序</td>
                                    <td>sort_order</td>
                                    <td><span class="column-type">INTEGER</span></td>
                                    <td>表示順</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
                <section id="master-referral" class="table-definition">
                    <h2><i data-lucide="database"></i> 認知経路マスター (master_referral_source)</h2>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>論理名</th>
                                    <th>物理名 (列名)</th>
                                    <th>データ型</th>
                                    <th>備考</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ID</td>
                                    <td>id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>PK</td>
                                </tr>
                                <tr>
                                    <td>名称</td>
                                    <td>name</td>
                                    <td><span class="column-type">VARCHAR(100)</span></td>
                                    <td>学校の先生, ポスターなど</td>
                                </tr>
                                <tr>
                                    <td>順序</td>
                                    <td>sort_order</td>
                                    <td><span class="column-type">INTEGER</span></td>
                                    <td>表示順</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Applicants Table -->
                <section class="table-definition">
                    <h2><i data-lucide="table-2"></i> 応募者 (applicants)</h2>
                    <p>外部公募による中高生応募者の情報を管理します。</p>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>論理名</th>
                                    <th>物理名 (列名)</th>
                                    <th>データ型</th>
                                    <th>備考</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ID</td>
                                    <td>id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>PK</td>
                                </tr>
                                <tr>
                                    <td>氏名</td>
                                    <td>full_name</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>ふりがな</td>
                                    <td>full_kana</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>性別</td>
                                    <td>gender</td>
                                    <td><span class="column-type">VARCHAR(20)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>学校ID</td>
                                    <td>school_id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>FK: master_school.id</td>
                                </tr>
                                <tr>
                                    <td>学年</td>
                                    <td>grade</td>
                                    <td><span class="column-type">VARCHAR(50)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>希望役割1ID</td>
                                    <td>desired_role_1_id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>FK: master_role.id</td>
                                </tr>
                                <tr>
                                    <td>希望役割2ID</td>
                                    <td>desired_role_2_id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>FK: master_role.id</td>
                                </tr>
                                <tr>
                                    <td>希望役割3ID</td>
                                    <td>desired_role_3_id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>FK: master_role.id</td>
                                </tr>
                                <tr>
                                    <td>決定役割ID</td>
                                    <td>assigned_role_id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>FK: master_role.id</td>
                                </tr>
                                <tr>
                                    <td>認知経路ID</td>
                                    <td>referral_source_id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>FK: master_referral_source.id</td>
                                </tr>
                                <tr>
                                    <td>認知経路のその他</td>
                                    <td>referral_source_other</td>
                                    <td><span class="column-type">TEXT</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>メールアドレス</td>
                                    <td>email</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>電話番号</td>
                                    <td>phone</td>
                                    <td><span class="column-type">VARCHAR(20)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>要望・メッセージ</td>
                                    <td>message</td>
                                    <td><span class="column-type">TEXT</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>状態</td>
                                    <td>status</td>
                                    <td><span class="column-type">VARCHAR(50)</span></td>
                                    <td>新規, 確認済み, 選抜済など</td>
                                </tr>
                                <tr>
                                    <td>LINE USER ID</td>
                                    <td>line_user_id</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>応募日時</td>
                                    <td>created_at</td>
                                    <td><span class="column-type">TIMESTAMP</span></td>
                                    <td>申し込みが完了した日時</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- LINE Messages Table -->
                <section class="table-definition">
                    <h2><i data-lucide="table-2"></i> LINEメッセージ (line_messages)</h2>
                    <p>公式LINEから配信されるメッセージの履歴と承認ステータスを管理します。</p>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>論理名</th>
                                    <th>物理名 (列名)</th>
                                    <th>データ型</th>
                                    <th>備考</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ID</td>
                                    <td>id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>プライマリキー</td>
                                </tr>
                                <tr>
                                    <td>配信対象</td>
                                    <td>target_type</td>
                                    <td><span class="column-type">VARCHAR(50)</span></td>
                                    <td>external (対外), internal (対内)</td>
                                </tr>
                                <tr>
                                    <td>タイトル</td>
                                    <td>title</td>
                                    <td><span class="column-type">VARCHAR(255)</span></td>
                                    <td>管理用タイトル</td>
                                </tr>
                                <tr>
                                    <td>本文</td>
                                    <td>message_body</td>
                                    <td><span class="column-type">TEXT</span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>配信予定日時</td>
                                    <td>scheduled_at</td>
                                    <td><span class="column-type">TIMESTAMP</span></td>
                                    <td>平日 09:30-20:30 のみ許可</td>
                                </tr>
                                <tr>
                                    <td>作成者ID</td>
                                    <td>created_by</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>メッセージ作成者のユーザーID</td>
                                </tr>
                                <tr>
                                    <td>承認者ID</td>
                                    <td>approved_by</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>承認作業を行ったユーザーID</td>
                                </tr>
                                <tr>
                                    <td>承認日時</td>
                                    <td>approved_at</td>
                                    <td><span class="column-type">TIMESTAMP</span></td>
                                    <td>承認が完了した日時</td>
                                </tr>
                                <tr>
                                    <td>承認ステータス</td>
                                    <td>status</td>
                                    <td><span class="column-type">VARCHAR(50)</span></td>
                                    <td>pending (承認待ち), scheduled (送信待ち), sent (送信済み), rejected (却下)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- LINE Received Messages Table -->
                <section class="table-definition">
                    <h2><i data-lucide="table-2"></i> LINE受信メッセージ (line_received_messages)</h2>
                    <p>ユーザーからLINE公式アカウントに送信されたメッセージを管理します。</p>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>論理名</th>
                                    <th>物理名 (列名)</th>
                                    <th>データ型</th>
                                    <th>備考</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ID</td>
                                    <td>id</td>
                                    <td><span class="column-type">UUID</span></td>
                                    <td>プライマリキー</td>
                                </tr>
                                <tr>
                                    <td>LINE USER ID</td>
                                    <td>line_user_id</td>
                                    <td><span class="column-type">VARCHAR(50)</span></td>
                                    <td>送信者のLINEユーザーID</td>
                                </tr>
                                <tr>
                                    <td>メッセージ内容</td>
                                    <td>message_text</td>
                                    <td><span class="column-type">TEXT</span></td>
                                    <td>受信したテキスト</td>
                                </tr>
                                <tr>
                                    <td>受信日時</td>
                                    <td>received_at</td>
                                    <td><span class="column-type">TIMESTAMP</span></td>
                                    <td>メッセージ受信日時</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../assets/js/supabase-client.js"></script>
    <script src="components.js"></script>
    <script src="../assets/js/admin.js"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>

</html>